apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: containerize-task
spec:
  inputs:
    params:
      - name: task-pvc
        description: the task pvc - this is the volume where the files (Dockerfile etc..) are expected to be
      # - name: additionalTags
      #   type: array
      #   default: []
    # resources:
    #   # TODO consider an optional git repository as the source of the image to build
    #   # when cd tekton support will be to tekton pipeline v 0.10
    #   - name: workspace
    #     type: git
    #     optional: true
  outputs:
    resources:
      - name: builtImage1
        type: image
      - name: builtImage2
        type: image
  steps:
    - name: build-image
      image: ibmcom/pipeline-base-image
      workingDir: /steps
      command: ["/bin/bash", "-c"]
      args:
        - |
          ls -l 
      volumeMounts:
        - mountPath: /artifacts
          name: task-volume
        - mountPath: /steps
          name: steps-volume
  volumes:
    - name: steps-volume
      emptyDir: {}
    - name: task-volume
      persistentVolumeClaim:
        claimName: $(inputs.params.task-pvc)
